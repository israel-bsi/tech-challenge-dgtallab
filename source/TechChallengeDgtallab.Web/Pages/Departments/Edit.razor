@page "/departamentos/editar/{id:int}"
@using TechChallengeDgtallab.Core.DTOs
@using TechChallengeDgtallab.Core.Requests.Collaborator
@using TechChallengeDgtallab.Core.Requests.Department
@inherits EditDepartmentPage

<PageTitle>Editar Departamento</PageTitle>

<MudText Typo="Typo.h4">Editar Departamento</MudText>

@if (IsBusy)
{
    <SkeletonWave />
}
else
{
    <MudPaper Class="pa-8 mt-4" Elevation="2">
        <EditForm OnValidSubmit="OnValidSubmitAsync" Model="InputModel">
            <ObjectGraphDataAnnotationsValidator />
            <MudTextField T="string"
                          Label="Nome do Departamento"
                          @bind-Value="InputModel.Name"
                          For="@(() => InputModel.Name)"
                          InputType="InputType.Text"
                          Class="mb-4" />

            <MudSelect T="CollaboratorDto"
                       Label="Gerente"
                       Value="InputModel.Manager"
                       ValueChanged="OnSelectedManagerValueChanged"
                       Class="mb-4">
                @foreach (var collaborator in Collaborators)
                {
                    <MudSelectItem T="CollaboratorDto" Value="@collaborator">@collaborator</MudSelectItem>
                }
            </MudSelect>

            <MudSelect T="DepartmentDto"
                       Label="Departamento Superior"
                       Value="InputModel.SuperiorDepartment"
                       ValueChanged="OnSelectedSuperiorDepartmentValueChanged"
                       Class="mb-4">
                @foreach (var department in Departments)
                {
                    <MudSelectItem Value="@department">@department</MudSelectItem>
                }
            </MudSelect>

            <MudButton ButtonType="ButtonType.Submit"
                       Variant="Variant.Filled"
                       Color="Color.Primary"
                       Class="mt-6"
                       StartIcon="@Icons.Material.Filled.Save">
                Salvar
            </MudButton>
        </EditForm>
    </MudPaper>
}