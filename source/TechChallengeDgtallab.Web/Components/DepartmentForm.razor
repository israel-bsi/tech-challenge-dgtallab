@using TechChallengeDgtallab.Core.Requests
@inherits DepartmentFormComponent

<PageTitle>@Operation Departamento</PageTitle>

<MudText Typo="Typo.h4">@Operation Departamento</MudText>

@if (IsBusy)
{
    <SkeletonWave />
}
else
{
    <MudPaper Class="pa-8 mt-4" Elevation="2">
        <EditForm OnValidSubmit="OnValidSubmitAsync" Model="InputModel">
            <DataAnnotationsValidator />
            <MudTextField T="string"
                          Label="Nome do Departamento"
                          @bind-Value="InputModel.Name"
                          For="@(() => InputModel.Name)"
                          InputType="InputType.Text"
                          Class="mb-4" />

            @if (InputModel.Id > 0)
            {
                <MudSelect T="EditCollaboratorRequest"
                           Label="Gerente"
                           Value="InputModel.Manager"
                           ValueChanged="OnSelectedManagerValueChanged"
                           Class="mb-4">
                    @foreach (var collaborator in Collaborators)
                    {
                        <MudSelectItem T="EditCollaboratorRequest" Value="@collaborator">@collaborator</MudSelectItem>
                    }
                </MudSelect>

                <MudSelect T="SuperiorDepartmentRequest"
                           Label="Departamento Superior"
                           Value="InputModel.SuperiorDepartment"
                           ValueChanged="OnSelectedSuperiorDepartmentValueChanged"
                           Class="mb-4">
                    @foreach (var department in Departments)
                    {
                        <MudSelectItem Value="@department">@department</MudSelectItem>
                    }
                </MudSelect>
            }

            <MudButton ButtonType="ButtonType.Submit"
                       Variant="Variant.Filled"
                       Color="Color.Primary"
                       Class="mt-6"
                       StartIcon="@Icons.Material.Filled.Save">
                Salvar
            </MudButton>
        </EditForm>
    </MudPaper>
}